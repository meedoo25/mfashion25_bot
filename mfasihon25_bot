from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes, ConversationHandler

# Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
FULL_NAME, PHONE_NUMBER, ID_CARD = range(3)

# ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª
BOT_TOKEN = "7661351506:AAHtp4gqY_FPrUR2Qnasec5UyWY64GOD9hA"

# Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
ADMIN_IDS = [123456789, 987654321]  # âœï¸ Ø¨Ø¯Ù‘Ù„Ù‡Ù… Ø¨Ù€ ID Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… ÙˆØ§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ

# Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("ğŸ“‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙÙŠ M.Fashion.25\nÙ…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„:")
    return FULL_NAME

# Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„
async def full_name(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["full_name"] = update.message.text
    await update.message.reply_text("ğŸ“± Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ:")
    return PHONE_NUMBER

# Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
async def phone_number(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["phone"] = update.message.text
    await update.message.reply_text("ğŸªª Ø£Ø±Ø³Ù„ Ø±Ù‚Ù… Ø¨Ø·Ø§Ù‚Ø© ØªØ¹Ø±ÙŠÙÙƒ (Ø£Ùˆ ØµÙˆØ±Ø©):")
    return ID_CARD

# Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ¹Ø±ÙŠÙ
async def id_card(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.message.from_user
    context.user_data["id_card"] = update.message.text if update.message.text else "ğŸ“· ØµÙˆØ±Ø© Ù…Ø±Ø³Ù„Ø©"

    message = (
        f"ğŸ†• ØªØ³Ø¬ÙŠÙ„ Ø¹Ø§Ù…Ù„ Ø¬Ø¯ÙŠØ¯:\n\n"
        f"ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: {context.user_data['full_name']}\n"
        f"ğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: {context.user_data['phone']}\n"
        f"ğŸ†” Ø¨Ø·Ø§Ù‚Ø© ØªØ¹Ø±ÙŠÙ: {context.user_data['id_card']}\n"
        f"ğŸ—£ï¸ Ù…Ù† Ø·Ø±Ù: @{user.username or 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…'}"
    )

    for admin_id in ADMIN_IDS:
        await context.bot.send_message(chat_id=admin_id, text=message)

    await update.message.reply_text("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø©.\nğŸ“Œ Ø³Ù†Ø±Ø§Ø³Ù„Ùƒ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯.")
    return ConversationHandler.END

# Ø¥Ù„ØºØ§Ø¡
async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("âŒ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.")
    return ConversationHandler.END

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
app = ApplicationBuilder().token(BOT_TOKEN).build()

# ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
conv_handler = ConversationHandler(
    entry_points=[CommandHandler("start", start)],
    states={
        FULL_NAME: [MessageHandler(filters.TEXT & ~filters.COMMAND, full_name)],
        PHONE_NUMBER: [MessageHandler(filters.TEXT & ~filters.COMMAND, phone_number)],
        ID_CARD: [MessageHandler(filters.ALL & ~filters.COMMAND, id_card)],
    },
    fallbacks=[CommandHandler("cancel", cancel)],
)

app.add_handler(conv_handler)

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
app.run_polling()
